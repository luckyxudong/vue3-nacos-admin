# 01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目

作为一个追求代码优雅的程序员，我一直认为：好的开始是成功的一半。

Vue 官方提供了`create-vue`项目脚手架工具，使用该工具可以快速创建 Vue3 全家桶工程，但每次创建工程后，几乎都需要对工程进行相同的调整：

- 要么生成一堆无用的示例文件，要么啥都没有
- 目录结构需要调整以符合团队规范
- 代码组织方式不够优雅
- 基础样式需要重复初始化
- 常用工具和插件需要逐个集成
- ......

## ☆ 建设目标 ☆

一个优秀的基础模板不仅能解决这些问题，还能整合提升开发效率的工具。 通过本系列文章，咱一步步构建一个优雅、高效的 Vue3 通用模板项目，为后续实现智能问卷系统奠定坚实基础。

一个优雅的基础模版工程需要支持：

- 原子化 CSS：UnoCSS
- 便捷使用 iconify-icon
- SVG 图标
- 基于文件系统的路由
- 自动导入插件
- 组件自动注册插件
- 打包构建优化配置
- 多环境
- 多语言
- ...

开发完基础模板工程后，可以将其提交到 Git，需要创建新项目时直接 checkout 即可；同时可以创建多个分支，每个分支提供不同的扩展能力，如集成 Element Plus、集成 Qiankun 等。也可以封装一个命令行工具，通过命令行快速创建符合企业内部规范的基础工程。

## 0 开发环境及依赖版本

### 开发环境

开发环境使用当下主流的 NodeJS + pnpm 组合。可以使用 `node -v`、`pnpm -v`查看版本号，优雅哥当前使用的版本为：

- Node：v22.16.0
- pnpm：10.27.0

说明：

- 建议使用 nvm 来管理多个 Node 版本，方便在不同项目间切换
- 可使用 `npm install -g pnpm`来安装 pnpm 版本
- 可使用 `pnpm self-update`来更新 pnpm 版本

### 关于版本选择的吐槽

通常情况下，选择依赖版本，主要考虑以下因素：

> 1. 稳定性：选择经过充分测试的稳定版本
> 2. 兼容性：确保各依赖之间版本匹配，避免冲突
> 3. 功能性：满足项目的基本需求

从理论上来说，很正确！关于“稳定”，大多数教程都会说：要追求稳定的，不要追求新的。 

但在我看来：**“追求稳定”就是一个瞎屁**！**个人学习时就应该大胆使用最新 release 版本**！主要基于以下四个原因：

1. 除了明显的如 alpha、beta 等标识，你如何知道某个版本就是稳定版？陈旧的版本就是所谓的稳定吗？
2. 最新的 release 版为啥就可能会不稳定？确定存在哪些 issue？这些 issue 对你产生多大么影响？
3. 所谓旧的稳定版，在刚发布的时候，难道不是最新版吗？
4. 在个人学习过程中都不敢使用最新 release 版，那什么时候才去使用？在生产环境中使用？

但“**兼容性**”不能忽视，不兼容的版本千万别去乱搞，“志不同，不相为谋”，不同依赖的不同版本，一定要确保兼容！

不过使用 vue3 没这么多破事！ 通过官方脚手架创建项目，默认给你配置好了最新的、可兼容的版本，其他的依赖直接上新版！

咱使用的版本号如下：

| 依赖                        | 版本           | 描述                   |
| :-------------------------- | :------------- | :--------------------- |
| vue                         | ^3.5.26        | 核心库                 |
| vite                        | ^7.3.0         | 构建工具               |
| vue-router                  | ^4.6.4         | 官方路由               |
| pinia                       | ^3.0.4         | 官方状态管理           |
| pinia-plugin-persistedstate | ^4.7.1         | 状态管理持久化插件     |
| vueuse                      | ^14.0.0        | hooks                  |
| unocss                      | 66.1.0-beta.11 | 原子化样式             |
| unplugin-vue-router         | ^0.19.2        | 基于文件系统的路由插件 |
| unplugin-auto-import        | ^20.2.0        | 自动引入插件           |
| unplugin-vue-components     | ^30.0.0        | 组件自动注册插件       |
| vite-plugin-vue-layouts     | ^0.11.0        | 布局插件               |

每间隔一段时间，我们需要升级模板工程的依赖版本，以保证安全性和性能。优雅哥以后会分享**如何简单便捷的全面升级项目依赖版本**。

## 1 初始化项目

### 1.1 创建项目

使用 vue 官方脚手架创建项目即可：

```
pnpm create vue@latest
```

根据向导进行选择：

![创建项目](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)创建项目

- 项目名为 wumeng-vue3-app-template（乌蒙 vue3 应用模版）
- 添加了 TypeScript、TSX 的支持
- 集成 Vue Router、Pinia
- 使用 ESLint 和 Prettier 规范代码。

回车后，在下一步的选择实验性功能时，优雅哥就保守了，两者都没有选择：![experimental features](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)experimental features

回车，是否不生成示例代码、仅创建空的项目，我选 Yes。如果选择 No，则会创建一堆乱七八糟的文件；如果选择 Yes，那啥都没有。咱选 Yes，从空白开始打磨![空项目](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)空项目

回车，等待创建。项目创建完成后，在命令行中进入项目根目录，安装依赖：

```
cd wumeng-vue3-app-template

pnpm i
```

如果使用 npm 官方注册中心 https://registry.npmjs.org/, 安装依赖速度可能会稍慢，可以切换为 taobao 注册中心 https://registry.npmmirror.com/

> 推荐使用 nrm 管理多个注册中心，可以很方便进行切换。（关于 nrm 和 nvm 的使用，可以搜索优雅哥的历史文章，几年过去，这两个工具依旧没啥变化）

依赖安装完成后，启动项目，测试是否正常运行：

```
pnpm dev
```

项目正常启动后，在浏览器中访问

http://localhost:5173/

若页面能正常显示，且控制台不报任何异常，则项目创建成功。

这个时候建议初始化 Git 仓库以便进行版本管理：

```
# 初始化 Git 仓库
git init

# 添加所有文件
gitadd.

# 提交初始化代码
git commit -m"chore: 初始化 Vue3 模板项目"
```

### 1.2 配置 IDE

使用你习惯的 IDE 打开项目并进行相应配置。

优雅哥多年来一直使用 WebStorm，下面是基于 WebStorm 的配置步骤，使用 VSCode 的伙伴可以略过这个部分，自行配置即可。

使用 WebStorm 打开项目，依次进行如下配置：

1. Node.js 配置 Node.js 的版本以及包管理工具：![NodeJS 的设置](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)NodeJS 的设置
2. ESLint 开启 ESLint，自动寻找 ESLint 的配置文件，并在保存时修复错误。![ESLint 的设置](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)ESLint 的设置
3. Prettier 开启 Prettier，自动寻找 Prettier 的配置，并且保存时格式化。![Prettier 的设置](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)Prettier 的设置

## 2 调整项目文件

### 2.1 删除文件

由于在创建项目的时候，选择了创建空项目、不生成示例代码，故项目文件比较少。src 中默认创建的目录只有 `router`和 `stores`。

这里只需要删除 stores 中的文件即可，目录保留着。![src中的目录文件](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)src中的目录文件

### 2.2 创建测试页面

在 `src`中创建目录 `views`, 并在该目录中创建 `demo.vue`作为测试页面：

```
<template>
  <div class="demo">demo</div>
</template>
```

由于开启了 ESLint，创建该文件后，会提示错误：`Component name "demo" should always be multi-word`。![ESLint 错误信息](01 - 实现优雅的现代 Vue3 通用模版 - 初始化项目.assets/640)ESLint 错误信息

在 `eslint.config.ts`中关闭该规则：

```
exportdefaultdefineConfigWithVueTs(
  ...

  {
    rules: {
      'vue/multi-word-component-names':'off',
    },
  },
)
```

> 在实际开发中，组件名使用多单词形式是一个好习惯，但对于测试页面和一些简单组件，单单词命名也可以接受，因此这里关闭该规则。

> 不同时期 create-vue 脚手架创建出来的项目中的 ESLint 配置文件都有很多变化，即使对应 vue 的版本都是 3.5.x，依然有一些不同的地方。

### 2.3 配置路由

修改`src/router/index.ts`文件，在该文件中配置 demo.vue 的路由，并且在文件最后导出 **installRouter**方法，以便实现模块化注册：

```
import{ createRouter, createWebHistory }from'vue-router'
importtype{ App }from'vue'

const router =createRouter({
  history:createWebHistory(import.meta.env.BASE_URL),
  routes:[
    {
      path:'/',
      redirect:'/demo'
    },
    {
      path:'/demo',
      name:'demo',
      component:()=>import('@/views/demo.vue')
    }
  ]
})

exportconstinstallRouter=(app: App)=>{
  app.use(router)
}

exportdefault router
```

### 2.4 修改 main.ts 的代码

调整 `src/main.ts`，删除集成 pinia 和 router 的相关代码，并调用 `installRouter`方法安装路由：

```
import{ createApp }from'vue'

import App from'./App.vue'
import{ installRouter }from'@/router'

const app =createApp(App)
installRouter(app)
app.mount('#app')
```

### 2.5 清理App.vue

删除 App.vue 中的无用代码，增加路由插座 router-view：

```
<template>
  <router-view/>
</template>
<scriptsetuplang="ts"></script>
<stylescoped></style>
```

现在可以启动项目，测试是否能正常运行。如果访问根路径能跳转 demo 路由，显示demo页面，并且浏览器控制台不报任何错误，则说明项目初始化成功。

至此，我们完成了项目的初始化和代码重构工作，包括：

- 使用官方脚手架创建基础项目
- 配置开发环境和 IDE 以提升开发体验
- 清理冗余文件和代码，保持项目结构清晰
- 重构路由配置，采用 `installRouter`方法实现模块化注册
- 简化 App.vue 结构，只保留核心路由插座

这些调整为后续集成 UnoCSS、自动路由、组件自动注册等工具做好了准备，将进一步提升开发效率和代码质量。

## 结语

在下一篇文章中，我们将开始集成 Pinia 状态管理，为模板项目添加状态管理能力，并配置持久化存储。这将使模板能够更好地管理应用状态，进一步提升其实用性和扩展性。